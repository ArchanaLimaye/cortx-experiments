# Kubernetes 
Kubernetes is an open-source container-orchestration system for automating computer application deployment, scaling, and management.
## Working scenario
Here in this scenario, we will be creating a pod consisting of two containers. The main container built using Nginx image pulled from docker hub and a sidecar container built from Logstash image (configured).  

A sidecar is a utility container in a pod that’s loosely coupled to the main application container. Why it must be placed in the same Pod is that it needs to use the same resources being used by the main container. It acts as an auxillary container that helps enhance and assist the main container in a pod. A pod spec which runs the main container and a helper container that does some utility work, but that is not necessarily needed for the main container to work. 

The sidecar container will act as a log collector and shipper; which will collect the logs generated by the main nginx container and ship those logs to elastic search.  
 
Logs are very useful to monitor activities of any application apart from providing you with valuable information while you troubleshoot it. 

Like any other application, NGINX also records events like visitors to your site, issues it encountered and more to log files. This information enables you to take preemptive measures in case you notice some serious discrepancies in the log events. By default, NGINX writes its events in two types of logs – the error log and the access log. By default, the access log is located at var/log/nginx/access.log 

So our sidecar container named “sidecar” will fetch the access.log of main container named “main” as defined in the pod manifest “application.yml” file. 

In the application.yml file we have definition of both containers with two shared volumes. One for access.log and other is a ‘checkpoint’. In checkpoint we have our ‘sincedb.log’ file which will have the track of the current position of monitored log files.  

 
 Following commands will create and configure the Pod according to the manifest. 
 ```python
kubectl apply –f application.yml 
```
To check if pod is properly ready and running:

 ```python
 kubectl get pods 
```
OUTPUT:

 ```python
   NAME            READY       STATUS    RESTARTS    

applicationpod      2/2        Running       0        
```
(if you see the above output then, pod is successfully created and is running.) 
You can check status of containers and verify the volume mounts in pod using,

 ```python
kubectl describe pod <pod-name> 
```
To take a look at the logs for this container, we'll use, 
 ```python
kubectl log <pod-name> <container-name>  
```
The sidecar container will run in the same pod along with the main container, mounting the same volume and processing the logs separately. 

You can verify the sincedb and log files by executing into the container using, 

 ```python
kubectl exec --stdin --tty <pod-name> --container <container-name> -- /bin/sh 
```
Output: 
 ```python
Path for access.log: /var/log/nginx/access.log 

Path for sincedb.log: /checkpoint/sincedb.log

```
